{% extends 'base.html' %}

{% block content %}
  <div class="flex items-center justify-between mb-6">
    <div>
      <h2 class="text-2xl font-semibold">Users — Submitted Proposals</h2>
     </div>
    <div>
      <a href="{{ url_for('new_proposal') }}" class="px-3 py-2 border bg-[#4e382a]  text-white rounded text-sm">New Proposal</a>
    </div>
  </div>

  {% if proposals %}
    <div class="bg-white rounded-lg shadow overflow-hidden">
      <table class="min-w-full table-auto">
        <thead class="bg-[#4e382a]">
          <tr>
            <th class="px-4 py-3 text-left text-xs font-medium text-white">ID</th>
            <th class="px-4 py-3 text-left text-xs font-medium text-white">Client</th>
            <th class="px-4 py-3 text-left text-xs font-medium text-white">Title</th>
            <th class="px-4 py-3 text-left text-xs font-medium text-white">Project Type</th>
            <th class="px-4 py-3 text-left text-xs font-medium text-white">Amount</th>
            <th class="px-4 py-3 text-left text-xs font-medium text-white">Status</th>
            <th class="px-4 py-3 text-left text-xs font-medium text-white">Created</th>
            <th class="px-4 py-3 text-left text-xs font-medium text-white">Actions</th>
          </tr>
        </thead>
        <tbody class="divide-y divide-gray-200">
          {% for proposal in proposals %}
            <tr class="{% if loop.index % 2 == 0 %}bg-[#f6f2ef]{% else %}bg-white{% endif %} hover:bg-gray-100">
              <td class="px-4 py-3 text-sm">{{ proposal.id }}</td>
              <td class="px-4 py-3 text-sm">{{ proposal.client_name if proposal.client_name else 'N/A' }}</td>
              <td class="px-4 py-3 text-sm">{{ proposal.title }}</td>
              <td class="px-4 py-3 text-sm">{{ proposal.project_type }}</td>
              <td class="px-4 py-3 text-sm">₹{{ '{:,.2f}'.format(proposal.amount) }}</td>
              <td class="px-4 py-3 text-sm">
                <span class="px-2 py-1 rounded text-xs {% if proposal.status == 'Draft' %}bg-gray-200 text-gray-700{% elif proposal.status == 'Submitted' %}bg-blue-200 text-blue-700{% elif proposal.status == 'Approved' %}bg-green-200 text-green-700{% else %}bg-yellow-200 text-yellow-700{% endif %}">
                  {{ proposal.status }}
                </span>
              </td>
              <td class="px-4 py-3 text-sm">{{ proposal.created_at[:10] if proposal.created_at else 'N/A' }}</td>
              <td class="px-4 py-3 text-sm">
                <div class="flex gap-3">
                  <a href="{{ url_for('view_proposal', proposal_id=proposal.id) }}" class="text-blue-600 hover:text-blue-800 font-medium">
                    View
                  </a>
                  <a href="{{ url_for('edit_proposal', proposal_id=proposal.id) }}" class="text-[#4e382a] hover:text-[#3d2316] font-medium">
                    Edit
                  </a>
                </div>
              </td>
            </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
  {% else %}
    <div class="bg-white rounded-lg shadow p-6 text-gray-600">No proposals submitted yet.</div>
  {% endif %}

{% endblock %}
